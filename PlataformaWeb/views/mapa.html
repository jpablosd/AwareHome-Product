<div>
    <div id="ver_alertas" class="row">
        <!--        <div class="col s2 m1 l1 "><p></p></div>-->
        <div class="col s12 m12 l12">
            <div class="card z-depth-3">
                <div class="card-content">
                    <div id="mapCanvas" ></div>


                </div>
            </div>
        </div>
    </div>
</div>   


<!-- CREAR ALERTA INTELIGENTE -->
<!--
<div class="content">
<div class="col s12 m12 l12">
<div class="card z-depth-3">
<div class="card-content">
<div class="col s12 m12 l12">
<div id="mapCanvas" ></div>
</div>
</div>
</div>
</div>
</div>
-->

<!-- Modal Structure -->
<div id="modal1" class="modal">
    <div class="modal-content">
        <h4>Hogar</h4>
        <div class="row">
            <div class="col s12 m12 l12">
                <p></p>
                <div class="card">
                    <div class="card-content">
                        <div >
                            <img  id="plano" src="images/plano.jpg">
                        </div>
                        <ul id="lista" class="collection col s12 m11 l12">
                            <!--
<li class="collection-item avatar">
<i class="mdi-action-assessment circle green"></i>
<span class="title">Title</span>
<p>First Line <br>
Second Line
</p>
<a href="#!" class="secondary-content"><i class="mdi-action-grade"></i></a>
</li>
-->
                        </ul>

                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#/verMapa" class="waves-effect waves-green btn-flat modal-action modal-close">Aceptar</a>
        </div>
    </div>
</div>








<script>
    var estadoAlertaMarker = 0;

    document.getElementById('modal1').style.display = 'none';

    //    var modal = document.getElementById('plano');
    //    modal.style.width = '500px !important';
    //    modal.style.height ='400px';

    var mapDiv = document.getElementById('mapCanvas');
    mapDiv.style.width = '100% !important';
    mapDiv.style.height ='600px';

    var map = new google.maps.Map(mapDiv, {
        center: new google.maps.LatLng(-33.0065,-71.5427),
        zoom: 15,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var nombreCasa;
    var latLng = new google.maps.LatLng(-33.0134008,-71.5420014);


    verHogar();

    var marker = new google.maps.Marker({
        position: latLng,
        title: 'arr[0].nombre_hogar',
        map: map,
        draggable: true
    });

    cargarAlertas();


    if (estadoAlertaMarker == 1){
        marker.setIcon("images/marker_red.png");
    }else{
        marker.setIcon("images/marker_green.png");
    }


    // Add dragging event listeners.
    google.maps.event.addListener(marker, 'click', function() {
        //alert("asdnasj");
        $('#modal1').openModal();
    });

    function verHogar(){
        var xmlhttp = new XMLHttpRequest();
        var url = "php/verHogar.php";

        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                myFunction(xmlhttp.responseText);
            }
        }
        xmlhttp.open("GET", url, true);
        xmlhttp.send();

        function myFunction(response) {

            //console.log(response);
            var arr = JSON.parse(response);
            latLng = google.maps.LatLng(arr[0].lat, arr[0].lng);
            nombreCasa = arr[0].nombre_hogar;
            //console.log(arr[0].nombre_hogar);
        }
    }




    //------------------- VER ALERTAS ----------------------
    function cargarAlertas(){
        var out = "";
        document.getElementById("lista").innerHTML = out;

        var xmlhttp = new XMLHttpRequest();
        var url = "php/verActualizarAlertas.php";

        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                myFunction(xmlhttp.responseText);
            }
        }
        xmlhttp.open("GET", url, true);
        xmlhttp.send();

        function myFunction(response) {
            console.log(response);

            var arr = JSON.parse(response);
            var i;

            for(i = 0; i < arr.length; i++) {
                console.log(arr[i].nombre_alerta);
                console.log(arr[i].sensor);
                console.log(arr[i].signo);
                console.log(arr[i].valor);
                console.log(arr[i].estado);
                var estado;
                if (arr[i].estado == 1){
                    estado = "Activada";
                    estadoAlertaMarker = 1;
                }else{
                    estado = "Desactivada";
                    estadoAlertaMarker = 0;
                }
                var sensor;
                if (arr[i].sensor == 1){
                    sensor = "Temperatura";
                }
                else if(arr[i].sensor == 2){
                    sensor = "Humedad";
                }
                else if(arr[i].sensor == 3){
                    sensor = "Gas";
                }

                out += "<li class='collection-item avatar'><i class='mdi-action-assessment circle green'></i><span class='title'>"+arr[i].nombre_alerta+"</span><p>"+sensor+" "+arr[i].signo+" "+arr[i].valor+"<br>"+estado+"</p><a href='#!' class='secondary-content'><i class='mdi-action-grade'></i></a></li>";
                //lista
            }
            //document.getElementById("lista").innerHTML = out;
            //$("#lista").html(out);

            $("#lista").prepend(out);
        }
    }
    //------------------- VER ALERTAS ----------------------


</script>